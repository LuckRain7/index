<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vuex | 震雨 luckrain7&#39;s 博客</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/index/favicon.ico">
    <meta name="description" content="震雨LuckRain7的博客,Webgis,arcgis,openlayer,css,javascript">
    <link rel="preload" href="/index/assets/css/0.styles.4df1c333.css" as="style"><link rel="preload" href="/index/assets/js/app.32e02e91.js" as="script"><link rel="preload" href="/index/assets/js/2.851f9801.js" as="script"><link rel="preload" href="/index/assets/js/18.294238b5.js" as="script"><link rel="preload" href="/index/assets/js/7.aed6fee3.js" as="script"><link rel="prefetch" href="/index/assets/js/10.605e56a2.js"><link rel="prefetch" href="/index/assets/js/11.1870263f.js"><link rel="prefetch" href="/index/assets/js/12.035506ea.js"><link rel="prefetch" href="/index/assets/js/13.4a8326d9.js"><link rel="prefetch" href="/index/assets/js/14.91072721.js"><link rel="prefetch" href="/index/assets/js/15.8682d163.js"><link rel="prefetch" href="/index/assets/js/16.c5f7f793.js"><link rel="prefetch" href="/index/assets/js/17.faacac80.js"><link rel="prefetch" href="/index/assets/js/19.5dc200dd.js"><link rel="prefetch" href="/index/assets/js/20.0bbade6b.js"><link rel="prefetch" href="/index/assets/js/21.d265328f.js"><link rel="prefetch" href="/index/assets/js/22.80a37b9b.js"><link rel="prefetch" href="/index/assets/js/23.1d66b236.js"><link rel="prefetch" href="/index/assets/js/24.e7988e8b.js"><link rel="prefetch" href="/index/assets/js/25.f2f858dd.js"><link rel="prefetch" href="/index/assets/js/26.3c2378a1.js"><link rel="prefetch" href="/index/assets/js/27.dcf22414.js"><link rel="prefetch" href="/index/assets/js/28.5bcccd5a.js"><link rel="prefetch" href="/index/assets/js/29.53ef7770.js"><link rel="prefetch" href="/index/assets/js/3.22f69fe6.js"><link rel="prefetch" href="/index/assets/js/30.bfc7777e.js"><link rel="prefetch" href="/index/assets/js/31.1e39e09e.js"><link rel="prefetch" href="/index/assets/js/32.95be3ca0.js"><link rel="prefetch" href="/index/assets/js/33.d3418809.js"><link rel="prefetch" href="/index/assets/js/34.7970c2aa.js"><link rel="prefetch" href="/index/assets/js/35.ce2660f2.js"><link rel="prefetch" href="/index/assets/js/36.4474270e.js"><link rel="prefetch" href="/index/assets/js/37.ec42ab0c.js"><link rel="prefetch" href="/index/assets/js/38.22f26e33.js"><link rel="prefetch" href="/index/assets/js/39.f7f1217d.js"><link rel="prefetch" href="/index/assets/js/4.5ee056e1.js"><link rel="prefetch" href="/index/assets/js/40.db986e14.js"><link rel="prefetch" href="/index/assets/js/41.bf8cd217.js"><link rel="prefetch" href="/index/assets/js/42.a7ac480b.js"><link rel="prefetch" href="/index/assets/js/43.a8b0d2c5.js"><link rel="prefetch" href="/index/assets/js/44.80b3bb15.js"><link rel="prefetch" href="/index/assets/js/45.6c4fc6f0.js"><link rel="prefetch" href="/index/assets/js/46.61af936a.js"><link rel="prefetch" href="/index/assets/js/47.9b0ad37b.js"><link rel="prefetch" href="/index/assets/js/48.1ade5fb0.js"><link rel="prefetch" href="/index/assets/js/49.c4bc0493.js"><link rel="prefetch" href="/index/assets/js/5.2af761ae.js"><link rel="prefetch" href="/index/assets/js/50.8079796c.js"><link rel="prefetch" href="/index/assets/js/51.dd81ba30.js"><link rel="prefetch" href="/index/assets/js/52.51bc69fb.js"><link rel="prefetch" href="/index/assets/js/53.2e9657e3.js"><link rel="prefetch" href="/index/assets/js/54.a833bfc4.js"><link rel="prefetch" href="/index/assets/js/55.3f09d51c.js"><link rel="prefetch" href="/index/assets/js/56.7b1820d8.js"><link rel="prefetch" href="/index/assets/js/57.1a21a56c.js"><link rel="prefetch" href="/index/assets/js/58.cc0aae83.js"><link rel="prefetch" href="/index/assets/js/59.21b8a559.js"><link rel="prefetch" href="/index/assets/js/6.627b3629.js"><link rel="prefetch" href="/index/assets/js/60.22785e46.js"><link rel="prefetch" href="/index/assets/js/61.52b8b885.js"><link rel="prefetch" href="/index/assets/js/62.89ad3709.js"><link rel="prefetch" href="/index/assets/js/63.a1ca137b.js"><link rel="prefetch" href="/index/assets/js/64.29c4284b.js"><link rel="prefetch" href="/index/assets/js/65.d8bfd39c.js"><link rel="prefetch" href="/index/assets/js/66.dfbeac62.js"><link rel="prefetch" href="/index/assets/js/67.b57b4d63.js"><link rel="prefetch" href="/index/assets/js/68.ca36c84c.js"><link rel="prefetch" href="/index/assets/js/69.5e9981b1.js"><link rel="prefetch" href="/index/assets/js/70.8fd0a4d0.js"><link rel="prefetch" href="/index/assets/js/71.e50c83eb.js"><link rel="prefetch" href="/index/assets/js/72.6fb33df1.js"><link rel="prefetch" href="/index/assets/js/73.6e15cc39.js"><link rel="prefetch" href="/index/assets/js/74.5a3d6a43.js"><link rel="prefetch" href="/index/assets/js/8.54ec9775.js"><link rel="prefetch" href="/index/assets/js/9.74784416.js">
    <link rel="stylesheet" href="/index/assets/css/0.styles.4df1c333.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/index/" class="home-link router-link-active"><!----> <span class="site-name">震雨 luckrain7's 博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/index/home/" class="nav-link">
  个人介绍
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/frontend/HTML.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/index/frontend/CSS.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/index/frontend/JavaScript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/index/frontend/TypeScript.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/index/Vue/Vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/index/React/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/index/frontend/Webpack/" class="nav-link">
  Webpack
</a></li></ul></div></div><div class="nav-item"><a href="/index/engineering/engineering/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><span class="title">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/ms/DesignMode.html" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/index/ms/Algorithm.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/index/ms/JavaScript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/index/ms/CSS.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/index/ms/safe.html" class="nav-link">
  前端安全
</a></li><li class="dropdown-item"><!----> <a href="/index/ms/Vue.html" class="nav-link">
  Vue
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务端" class="dropdown-title"><span class="title">服务端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/server/Node/" class="nav-link">
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/index/server/Golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/index/server/Python/" class="nav-link">
  Python
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="WebGIS" class="dropdown-title"><span class="title">WebGIS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/WebGIS/Cesium/" class="nav-link">
  Cesium
</a></li><li class="dropdown-item"><!----> <a href="/index/WebGIS/ArcGIS/" class="nav-link">
  ArcGIS
</a></li><li class="dropdown-item"><!----> <a href="/index/WebGIS/OpenLayer/" class="nav-link">
  OpenLayer
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="必备工具" class="dropdown-title"><span class="title">必备工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/tools/package/" class="nav-link">
  包管理器
</a></li><li class="dropdown-item"><!----> <a href="/index/tools/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/index/tools/GitHub/" class="nav-link">
  GitHub
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人分享" class="dropdown-title"><span class="title">个人分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/article/index.html" class="nav-link">
  文章
</a></li><li class="dropdown-item"><!----> <a href="/index/share/OpenSource.html" class="nav-link">
  开源项目
</a></li><li class="dropdown-item"><!----> <a href="/index/share/vscode.html" class="nav-link">
  VS Code 插件推荐
</a></li><li class="dropdown-item"><!----> <a href="/index/share/software/" class="nav-link">
  软件推荐
</a></li><li class="dropdown-item"><!----> <a href="/index/share/website.html" class="nav-link">
  网站推荐
</a></li><li class="dropdown-item"><!----> <a href="/index/frame/index.html" class="nav-link">
  前端工具框架推荐
</a></li><li class="dropdown-item"><!----> <a href="/index/share/config/" class="nav-link">
  配置文件
</a></li><li class="dropdown-item"><!----> <a href="/index/share/notes/" class="nav-link">
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/index/share/Social.html" class="nav-link">
  社交平台
</a></li></ul></div></div> <a href="https://github.com/LuckRain7" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/index/home/" class="nav-link">
  个人介绍
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/frontend/HTML.html" class="nav-link">
  HTML
</a></li><li class="dropdown-item"><!----> <a href="/index/frontend/CSS.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/index/frontend/JavaScript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/index/frontend/TypeScript.html" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/index/Vue/Vue.html" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/index/React/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/index/frontend/Webpack/" class="nav-link">
  Webpack
</a></li></ul></div></div><div class="nav-item"><a href="/index/engineering/engineering/" class="nav-link">
  前端工程化
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="面试" class="dropdown-title"><span class="title">面试</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/ms/DesignMode.html" class="nav-link">
  设计模式
</a></li><li class="dropdown-item"><!----> <a href="/index/ms/Algorithm.html" class="nav-link">
  算法
</a></li><li class="dropdown-item"><!----> <a href="/index/ms/JavaScript.html" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/index/ms/CSS.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/index/ms/safe.html" class="nav-link">
  前端安全
</a></li><li class="dropdown-item"><!----> <a href="/index/ms/Vue.html" class="nav-link">
  Vue
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务端" class="dropdown-title"><span class="title">服务端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/server/Node/" class="nav-link">
  Node.js
</a></li><li class="dropdown-item"><!----> <a href="/index/server/Golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/index/server/Python/" class="nav-link">
  Python
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="WebGIS" class="dropdown-title"><span class="title">WebGIS</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/WebGIS/Cesium/" class="nav-link">
  Cesium
</a></li><li class="dropdown-item"><!----> <a href="/index/WebGIS/ArcGIS/" class="nav-link">
  ArcGIS
</a></li><li class="dropdown-item"><!----> <a href="/index/WebGIS/OpenLayer/" class="nav-link">
  OpenLayer
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="必备工具" class="dropdown-title"><span class="title">必备工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/tools/package/" class="nav-link">
  包管理器
</a></li><li class="dropdown-item"><!----> <a href="/index/tools/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/index/tools/GitHub/" class="nav-link">
  GitHub
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人分享" class="dropdown-title"><span class="title">个人分享</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/index/article/index.html" class="nav-link">
  文章
</a></li><li class="dropdown-item"><!----> <a href="/index/share/OpenSource.html" class="nav-link">
  开源项目
</a></li><li class="dropdown-item"><!----> <a href="/index/share/vscode.html" class="nav-link">
  VS Code 插件推荐
</a></li><li class="dropdown-item"><!----> <a href="/index/share/software/" class="nav-link">
  软件推荐
</a></li><li class="dropdown-item"><!----> <a href="/index/share/website.html" class="nav-link">
  网站推荐
</a></li><li class="dropdown-item"><!----> <a href="/index/frame/index.html" class="nav-link">
  前端工具框架推荐
</a></li><li class="dropdown-item"><!----> <a href="/index/share/config/" class="nav-link">
  配置文件
</a></li><li class="dropdown-item"><!----> <a href="/index/share/notes/" class="nav-link">
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/index/share/Social.html" class="nav-link">
  社交平台
</a></li></ul></div></div> <a href="https://github.com/LuckRain7" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vuex</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/index/Vue/Vuex.html#_1-基础使用" class="sidebar-link">1. 基础使用</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/index/Vue/Vuex.html#_2-合理使用-vuex" class="sidebar-link">2. 合理使用 Vuex</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/index/Vue/Vuex.html#_3-mutations-和-actions-区别" class="sidebar-link">3. mutations 和 actions 区别</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/index/Vue/Vuex.html#_4-vuex-模抉化-module-管理" class="sidebar-link">4. vuex 模抉化 module 管理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/index/Vue/Vuex.html#基本代码示例：" class="sidebar-link">基本代码示例：</a></li></ul></li><li><a href="/index/Vue/Vuex.html#_5-数据持久化" class="sidebar-link">5. 数据持久化</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vuex"><a href="#vuex" class="header-anchor">#</a> Vuex</h1> <h2 id="_1-基础使用"><a href="#_1-基础使用" class="header-anchor">#</a> 1. 基础使用</h2> <p><a href="https://vuex.vuejs.org/zh/guide/" target="_blank" rel="noopener noreferrer">Vuex guide<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="_2-合理使用-vuex"><a href="#_2-合理使用-vuex" class="header-anchor">#</a> 2. 合理使用 Vuex</h2> <p>数据被多个组件频繁用到，如果只是被一个组件用到，那完全没有任何必要为了使用 vuex 和使用 vuex</p> <p><strong>举例</strong>：一个网站用户的昵称，账号，资料，像这种系统级别的信息随时可能在业务中展示，使用,如果在组件中存储,那么要获取 N 次，所以 <strong>系统级别的数据</strong> 是需要放置在 vuex 中的，那么系统级别数据也不能所以的放置，为了让数据看着更有层级结构感，可以按照像下面这样设计：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//系统消息</span>
<span class="token punctuation">{</span>
  system<span class="token operator">:</span><span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    setting<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>上面这种结构,一 看便知道我们应该哪里获取系统数据即设置数据</p></blockquote> <p>如果有些业务数据,也需要共享，最好按照模块的具体业务含义分类,比如下面</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token comment">//系统消息</span>
  system<span class="token operator">:</span><span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    setting<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  product<span class="token operator">:</span><span class="token punctuation">{</span>
    productList<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 商品信息列表</span>
    productOrders<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 商品订单列表</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>如上图代码所示，我们很清晰的能够分清楚每个模块的数据,这样不会导致数据管理的混乱。</p></blockquote> <h2 id="_3-mutations-和-actions-区别"><a href="#_3-mutations-和-actions-区别" class="header-anchor">#</a> 3. mutations 和 actions 区别</h2> <p>不同于 redux 只有一个 action， vuex 单独拎出了一个 mutations，它认为更新数据必须是同步的，也就是只要调
用了提交数据方法，在 mutation 里面才可以修改数据</p> <p>vuex 提供了专门做异步请求的模块：action。action 中也可以做同步操作，只不过分工更加明确，所有的数据操作不论是同步还是异步都可以在 action 中完成。mutation 只负责接收状态，同步完成，数据快照。</p> <p>所以可以认为</p> <ul><li>state =&gt; 负责存储状态</li> <li>mutations =&gt; 负责同步更新状态</li> <li>actions =&gt; 负责获取处理数据(如果有异步操作必须在 action 处理再到 mutation ) ，提交到 mutation 进
行状态更新</li></ul> <h2 id="_4-vuex-模抉化-module-管理"><a href="#_4-vuex-模抉化-module-管理" class="header-anchor">#</a> 4. vuex 模抉化 module 管理</h2> <p>vuex 维护的数据越来越复杂的时候，模块化的解决方案。</p> <p>解析：使用单一的状态树，应用的所有状态都会集中在一个比较大的对象上面，随着项目需求的不断增加，状态树也会变得越来越臃肿，增加了状态树维护的复杂度，而且代码变得沉长;因此我们需要 modules(模块化)来为我们的状态树分隔成不同的模块，每个模块拥有自己的 state，getters， mutations， actions； 而且允许每个 module 里面嵌套子 module；如下:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>store
  <span class="token operator">|</span>-- index.js            <span class="token comment"># 组装模块并导出 store 的地方</span>
  <span class="token operator">|</span>-- actions.js          <span class="token comment"># 根级别的 actions</span>
  <span class="token operator">|</span>-- mutations.js        <span class="token comment"># 根级别的 mutations</span>
  <span class="token operator">|</span>-- state.js            <span class="token comment"># 根级别的 state</span>
  <span class="token operator">|</span>-- modules
        <span class="token operator">|</span>-- module1.js    <span class="token comment"># 模块1的 state 树</span>
        <span class="token operator">|</span>-- module2.js    <span class="token comment"># 模块2的 state 树</span>
</code></pre></div><h3 id="基本代码示例："><a href="#基本代码示例：" class="header-anchor">#</a> 基本代码示例：</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// src/store/modules/user.js</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  namespaced<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>

  <span class="token comment">// 组件中使用规则 this.$store.state.模块名.变量名</span>
  <span class="token comment">// 组件中使用：this.$store.state.user.info</span>
  computed<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function-variable function">info</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> state<span class="token punctuation">.</span>user<span class="token punctuation">.</span>info<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  state<span class="token operator">:</span> <span class="token punctuation">{</span>
    info<span class="token operator">:</span> <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">&quot;Tom&quot;</span><span class="token punctuation">,</span>
      age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 组件中触发规则 this.$store.commit('模块名/变量名',赋值)</span>
  <span class="token comment">// 组件中触发 this.$store.commit('user/setInfo',value)</span>
  mutations<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">setInfo</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      state<span class="token punctuation">.</span>info <span class="token operator">=</span> val<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 组件中触发规则 this.$store.dispatch('模块名/变量名',赋值)</span>
  <span class="token comment">// 组件中触发 this.$store.dispatch('user/setInfo',value)</span>
  actions<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">setInfoActions</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> commit <span class="token punctuation">}</span><span class="token punctuation">,</span> val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">&quot;setInfo&quot;</span><span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 组件中触发规则 this.$store.getters['模块名/变量名']</span>
  <span class="token comment">// 组件中触发 this.$store.getters[&quot;user/doubleCountUserAge&quot;]</span>
  getters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">doubleCountUserAge</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> state<span class="token punctuation">.</span>info<span class="token punctuation">.</span>age <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_5-数据持久化"><a href="#_5-数据持久化" class="header-anchor">#</a> 5. 数据持久化</h2> <p>解决浏览器刷新后数据消失问题</p> <p>利用 vuex-persistedstate 插件，将 vuex 的数据存储到浏览器中，刷新后重新拿出来导入 vuex 中</p> <ul><li>安装</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> vuex-persistedstate  --save
or
<span class="token function">yarn</span> <span class="token function">add</span> vuex-persistedstate
</code></pre></div><ul><li>API
<ul><li><code>key&lt;String&gt;</code>: The key to store the persisted state under. Defaults to <code>vuex</code>.（设置存储 key 值）</li> <li><code>paths&lt;Array&gt;</code>: An array of any paths to partially persist the state. If no paths are given, the complete state is persisted. If an empty array is given, no state is persisted. Paths must be specified using dot notation. If using modules, include the module name. eg: &quot;auth.user&quot; Defaults to <code>undefined</code>.</li> <li><code>reducer&lt;Function&gt;</code>: A function that will be called to reduce the state to persist based on the given paths. Defaults to include the values.（设置需求数据进行数据持久化）</li> <li><code>subscriber&lt;Function&gt;</code>: A function called to setup mutation subscription. Defaults to <code>store =&gt; handler =&gt; store.subscribe(handler)</code>.</li> <li><code>storage&lt;Object&gt;</code>: Instead for (or in combination with) <code>getState</code> and <code>setState</code>. Defaults to localStorage.（设置存储位置）</li> <li><code>getState&lt;Function&gt;</code>: A function that will be called to rehydrate a previously persisted state. Defaults to using <code>storage</code>.</li> <li><code>setState&lt;Function&gt;</code>: A function that will be called to persist the given state. Defaults to using <code>storage</code>.</li> <li><code>filter&lt;Function&gt;</code>: A function that will be called to filter any mutations which will trigger <code>setState</code> on storage eventually. Defaults to <code>() =&gt; true</code>.</li> <li><code>overwrite&lt;Boolean&gt;</code>: When rehydrating, whether to overwrite the existing state with the output from <code>getState</code> directly, instead of merging the two objects with <code>deepmerge</code>. Defaults to <code>false</code>.</li> <li><code>arrayMerger&lt;Function&gt;</code>: A function for merging arrays when rehydrating state. Defaults to <code>function (store, saved) { return saved }</code> (saved state replaces supplied state).</li> <li><code>rehydrated&lt;Function&gt;</code>: A function that will be called when the rehydration is finished. Useful when you are using Nuxt.js, which the rehydration of the persisted state happens asynchronously. Defaults to <code>store =&gt; {}</code></li> <li><code>fetchBeforeUse&lt;Boolean&gt;</code>: A boolean indicating if the state should be fetched from storage before the plugin is used. Defaults to <code>false</code>.</li> <li><code>assertStorage&lt;Function&gt;</code>: An overridable function to ensure storage is available, fired on plugins's initialization. Default one is performing a Write-Delete operation on the given Storage instance. Note, default behaviour could throw an error (like <code>DOMException: QuotaExceededError</code>).</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> createPersistedState <span class="token keyword">from</span> <span class="token string">&quot;vuex-persistedstate&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">//默认存储到localStorage</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">createPersistedState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>

  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">createPersistedState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// 修改存储key值</span>
      key<span class="token operator">:</span> <span class="token string">&quot;module-vuex-key&quot;</span><span class="token punctuation">,</span>
      <span class="token comment">// 修改存储位置</span>
      storage<span class="token operator">:</span> window<span class="token punctuation">.</span>sessionStorage<span class="token punctuation">,</span>
      <span class="token comment">// 设置需要的数据进行持久化</span>
      <span class="token function">reducer</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
          userInfo<span class="token operator">:</span> val<span class="token punctuation">.</span>userInfo<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>vuex 引用多个插件的写法</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token function">plugins1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">plugins2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <div class="Vue"><div class="mid"><div>Vue 内部索引</div> <ul><li>Vue</li> <li>Vue-router</li> <li>Vuex</li> <li>Vue-CLI</li></ul></div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/index/assets/js/app.32e02e91.js" defer></script><script src="/index/assets/js/2.851f9801.js" defer></script><script src="/index/assets/js/18.294238b5.js" defer></script><script src="/index/assets/js/7.aed6fee3.js" defer></script>
  </body>
</html>
